# 效能優化

## 模型選擇策略

**Haiku 4.5**（Sonnet 90% 能力，3 倍成本節省）：
- 頻繁呼叫的輕量 agents
- 配對程式設計和程式碼產生
- 多 agent 系統中的 worker agents

**Sonnet 4.5**（最佳程式碼模型）：
- 主要開發工作
- 協調多 agent 工作流程
- 複雜程式碼任務

**Opus 4.5**（最深度推理）：
- 複雜架構決策
- 最大推理需求
- 研究和分析任務

## 上下文視窗管理

避免在上下文視窗的最後 20% 進行：
- 大規模重構
- 跨多個檔案的功能實作
- 除錯複雜互動

較低上下文敏感度任務：
- 單檔案編輯
- 獨立工具建立
- 文件更新
- 簡單 Bug 修復

## Ultrathink + Plan 模式

對於需要深度推理的複雜任務：
1. 使用 `ultrathink` 增強思考
2. 啟用 **Plan 模式** 以結構化方法
3. 用多輪批評「預熱引擎」
4. 使用分角色子 agents 進行多元分析

## 建置疑難排解

如果建置失敗：
1. 使用 **build-error-resolver** Agent
2. 分析錯誤訊息
3. 增量修復
4. 每次修復後驗證
