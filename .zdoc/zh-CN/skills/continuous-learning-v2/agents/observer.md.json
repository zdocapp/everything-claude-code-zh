{
  "sourceFile": "skills/continuous-learning-v2/agents/observer.md",
  "sourceLanguage": "en-US",
  "entries": [
    {
      "en-US": "---\nname: observer\ndescription: Background agent that analyzes session observations to detect patterns and create instincts. Uses Haiku for cost-efficiency.\nmodel: haiku\nrun_mode: background\n---",
      "zh-Hans": "---\nname: observer\ndescription: 背景代理，通过分析会话观察来检测模式并创建本能。使用俳句以实现成本效益。\nmodel: haiku\nrun_mode: background\n---"
    },
    {
      "en-US": "# Observer Agent",
      "zh-Hans": "# Observer Agent"
    },
    {
      "en-US": "A background agent that analyzes observations from Claude Code sessions to detect patterns and create instincts.",
      "zh-Hans": "一个后台代理，用于分析 Claude Code 会话中的观察结果，以检测模式并创建本能。"
    },
    {
      "en-US": "## When to Run",
      "zh-Hans": "## 何时运行"
    },
    {
      "en-US": "- After significant session activity (20+ tool calls)\n- When user runs `/analyze-patterns`\n- On a scheduled interval (configurable, default 5 minutes)\n- When triggered by observation hook (SIGUSR1)",
      "zh-Hans": "* 在显著会话活动后（20+ 工具调用）\n* 当用户运行 `/analyze-patterns` 时\n* 按计划间隔（可配置，默认 5 分钟）\n* 当被观察钩子触发时 (SIGUSR1)"
    },
    {
      "en-US": "## Input",
      "zh-Hans": "## 输入"
    },
    {
      "en-US": "Reads observations from `~/.claude/homunculus/observations.jsonl`:",
      "zh-Hans": "从 `~/.claude/homunculus/observations.jsonl` 读取观察结果："
    },
    {
      "en-US": "```jsonl\n{\"timestamp\":\"2025-01-22T10:30:00Z\",\"event\":\"tool_start\",\"session\":\"abc123\",\"tool\":\"Edit\",\"input\":\"...\"}\n{\"timestamp\":\"2025-01-22T10:30:01Z\",\"event\":\"tool_complete\",\"session\":\"abc123\",\"tool\":\"Edit\",\"output\":\"...\"}\n{\"timestamp\":\"2025-01-22T10:30:05Z\",\"event\":\"tool_start\",\"session\":\"abc123\",\"tool\":\"Bash\",\"input\":\"npm test\"}\n{\"timestamp\":\"2025-01-22T10:30:10Z\",\"event\":\"tool_complete\",\"session\":\"abc123\",\"tool\":\"Bash\",\"output\":\"All tests pass\"}\n```",
      "zh-Hans": "```jsonl\n{\"timestamp\":\"2025-01-22T10:30:00Z\",\"event\":\"tool_start\",\"session\":\"abc123\",\"tool\":\"Edit\",\"input\":\"...\"}\n{\"timestamp\":\"2025-01-22T10:30:01Z\",\"event\":\"tool_complete\",\"session\":\"abc123\",\"tool\":\"Edit\",\"output\":\"...\"}\n{\"timestamp\":\"2025-01-22T10:30:05Z\",\"event\":\"tool_start\",\"session\":\"abc123\",\"tool\":\"Bash\",\"input\":\"npm test\"}\n{\"timestamp\":\"2025-01-22T10:30:10Z\",\"event\":\"tool_complete\",\"session\":\"abc123\",\"tool\":\"Bash\",\"output\":\"All tests pass\"}\n```"
    },
    {
      "en-US": "## Pattern Detection",
      "zh-Hans": "## 模式检测"
    },
    {
      "en-US": "Look for these patterns in observations:",
      "zh-Hans": "在观察结果中寻找以下模式："
    },
    {
      "en-US": "### 1. User Corrections",
      "zh-Hans": "### 1. 用户更正"
    },
    {
      "en-US": "When a user's follow-up message corrects Claude's previous action:",
      "zh-Hans": "当用户的后续消息纠正了 Claude 之前的操作时："
    },
    {
      "en-US": "- \"No, use X instead of Y\"\n- \"Actually, I meant...\"\n- Immediate undo/redo patterns",
      "zh-Hans": "* \"不，使用 X 而不是 Y\"\n* \"实际上，我的意思是……\"\n* 立即的撤销/重做模式"
    },
    {
      "en-US": "→ Create instinct: \"When doing X, prefer Y\"",
      "zh-Hans": "→ 创建本能：\"当执行 X 时，优先使用 Y\""
    },
    {
      "en-US": "### 2. Error Resolutions",
      "zh-Hans": "### 2. 错误解决"
    },
    {
      "en-US": "When an error is followed by a fix:",
      "zh-Hans": "当错误发生后紧接着修复时："
    },
    {
      "en-US": "- Tool output contains error\n- Next few tool calls fix it\n- Same error type resolved similarly multiple times",
      "zh-Hans": "* 工具输出包含错误\n* 接下来的几个工具调用修复了它\n* 相同类型的错误以类似方式多次解决"
    },
    {
      "en-US": "→ Create instinct: \"When encountering error X, try Y\"",
      "zh-Hans": "→ 创建本能：\"当遇到错误 X 时，尝试 Y\""
    },
    {
      "en-US": "### 3. Repeated Workflows",
      "zh-Hans": "### 3. 重复的工作流"
    },
    {
      "en-US": "When the same sequence of tools is used multiple times:",
      "zh-Hans": "当多次使用相同的工具序列时："
    },
    {
      "en-US": "- Same tool sequence with similar inputs\n- File patterns that change together\n- Time-clustered operations",
      "zh-Hans": "* 具有相似输入的相同工具序列\n* 一起变化的文件模式\n* 时间上聚集的操作"
    },
    {
      "en-US": "→ Create workflow instinct: \"When doing X, follow steps Y, Z, W\"",
      "zh-Hans": "→ 创建工作流本能：\"当执行 X 时，遵循步骤 Y, Z, W\""
    },
    {
      "en-US": "### 4. Tool Preferences",
      "zh-Hans": "### 4. 工具偏好"
    },
    {
      "en-US": "When certain tools are consistently preferred:",
      "zh-Hans": "当始终偏好使用某些工具时："
    },
    {
      "en-US": "- Always uses Grep before Edit\n- Prefers Read over Bash cat\n- Uses specific Bash commands for certain tasks",
      "zh-Hans": "* 总是在编辑前使用 Grep\n* 优先使用 Read 而不是 Bash cat\n* 对特定任务使用特定的 Bash 命令"
    },
    {
      "en-US": "→ Create instinct: \"When needing X, use tool Y\"",
      "zh-Hans": "→ 创建本能：\"当需要 X 时，使用工具 Y\""
    },
    {
      "en-US": "## Output",
      "zh-Hans": "## 输出"
    },
    {
      "en-US": "Creates/updates instincts in `~/.claude/homunculus/instincts/personal/`:",
      "zh-Hans": "在 `~/.claude/homunculus/instincts/personal/` 中创建/更新本能："
    },
    {
      "en-US": "```yaml\n---\nid: prefer-grep-before-edit\ntrigger: \"when searching for code to modify\"\nconfidence: 0.65\ndomain: \"workflow\"\nsource: \"session-observation\"\n---\n\n# Prefer Grep Before Edit\n\n## Action\nAlways use Grep to find the exact location before using Edit.\n\n## Evidence\n- Observed 8 times in session abc123\n- Pattern: Grep → Read → Edit sequence\n- Last observed: 2025-01-22\n```",
      "zh-Hans": "```yaml\n---\nid: prefer-grep-before-edit\ntrigger: \"when searching for code to modify\"\nconfidence: 0.65\ndomain: \"workflow\"\nsource: \"session-observation\"\n---\n\n# Prefer Grep Before Edit\n\n## Action\nAlways use Grep to find the exact location before using Edit.\n\n## Evidence\n- Observed 8 times in session abc123\n- Pattern: Grep → Read → Edit sequence\n- Last observed: 2025-01-22\n```"
    },
    {
      "en-US": "## Confidence Calculation",
      "zh-Hans": "## 置信度计算"
    },
    {
      "en-US": "Initial confidence based on observation frequency:",
      "zh-Hans": "基于观察频率的初始置信度："
    },
    {
      "en-US": "- 1-2 observations: 0.3 (tentative)\n- 3-5 observations: 0.5 (moderate)\n- 6-10 observations: 0.7 (strong)\n- 11+ observations: 0.85 (very strong)",
      "zh-Hans": "* 1-2 次观察：0.3（初步）\n* 3-5 次观察：0.5（中等）\n* 6-10 次观察：0.7（强）\n* 11+ 次观察：0.85（非常强）"
    },
    {
      "en-US": "Confidence adjusts over time:",
      "zh-Hans": "置信度随时间调整："
    },
    {
      "en-US": "- +0.05 for each confirming observation\n- -0.1 for each contradicting observation\n- -0.02 per week without observation (decay)",
      "zh-Hans": "* 每次确认性观察 +0.05\n* 每次矛盾性观察 -0.1\n* 每周无观察 -0.02（衰减）"
    },
    {
      "en-US": "## Important Guidelines",
      "zh-Hans": "## 重要准则"
    },
    {
      "en-US": "1. **Be Conservative**: Only create instincts for clear patterns (3+ observations)\n2. **Be Specific**: Narrow triggers are better than broad ones\n3. **Track Evidence**: Always include what observations led to the instinct\n4. **Respect Privacy**: Never include actual code snippets, only patterns\n5. **Merge Similar**: If a new instinct is similar to existing, update rather than duplicate",
      "zh-Hans": "1. **保持保守**：仅为清晰模式（3+ 次观察）创建本能\n2. **保持具体**：狭窄的触发器优于宽泛的触发器\n3. **跟踪证据**：始终包含导致本能的观察结果\n4. **尊重隐私**：绝不包含实际代码片段，只包含模式\n5. **合并相似项**：如果新本能与现有本能相似，则更新而非重复"
    },
    {
      "en-US": "## Example Analysis Session",
      "zh-Hans": "## 示例分析会话"
    },
    {
      "en-US": "Given observations:",
      "zh-Hans": "给定观察结果："
    },
    {
      "en-US": "```jsonl\n{\"event\":\"tool_start\",\"tool\":\"Grep\",\"input\":\"pattern: useState\"}\n{\"event\":\"tool_complete\",\"tool\":\"Grep\",\"output\":\"Found in 3 files\"}\n{\"event\":\"tool_start\",\"tool\":\"Read\",\"input\":\"src/hooks/useAuth.ts\"}\n{\"event\":\"tool_complete\",\"tool\":\"Read\",\"output\":\"[file content]\"}\n{\"event\":\"tool_start\",\"tool\":\"Edit\",\"input\":\"src/hooks/useAuth.ts...\"}\n```",
      "zh-Hans": "```jsonl\n{\"event\":\"tool_start\",\"tool\":\"Grep\",\"input\":\"pattern: useState\"}\n{\"event\":\"tool_complete\",\"tool\":\"Grep\",\"output\":\"Found in 3 files\"}\n{\"event\":\"tool_start\",\"tool\":\"Read\",\"input\":\"src/hooks/useAuth.ts\"}\n{\"event\":\"tool_complete\",\"tool\":\"Read\",\"output\":\"[file content]\"}\n{\"event\":\"tool_start\",\"tool\":\"Edit\",\"input\":\"src/hooks/useAuth.ts...\"}\n```"
    },
    {
      "en-US": "Analysis:",
      "zh-Hans": "分析："
    },
    {
      "en-US": "- Detected workflow: Grep → Read → Edit\n- Frequency: Seen 5 times this session\n- Create instinct:\n  - trigger: \"when modifying code\"\n  - action: \"Search with Grep, confirm with Read, then Edit\"\n  - confidence: 0.6\n  - domain: \"workflow\"",
      "zh-Hans": "* 检测到工作流：Grep → Read → Edit\n* 频率：本次会话中看到 5 次\n* 创建本能：\n  * 触发器：\"when modifying code\"\n  * 操作：\"Search with Grep, confirm with Read, then Edit\"\n  * 置信度：0.6\n  * 领域：\"workflow\""
    },
    {
      "en-US": "## Integration with Skill Creator",
      "zh-Hans": "## 与 Skill Creator 集成"
    },
    {
      "en-US": "When instincts are imported from Skill Creator (repo analysis), they have:",
      "zh-Hans": "当本能从 Skill Creator（仓库分析）导入时，它们具有："
    },
    {
      "en-US": "- `source: \"repo-analysis\"`\n- `source_repo: \"https://github.com/...\"`",
      "zh-Hans": "* `source: \"repo-analysis\"`\n* `source_repo: \"https://github.com/...\"`"
    },
    {
      "en-US": "These should be treated as team/project conventions with higher initial confidence (0.7+).",
      "zh-Hans": "这些应被视为具有更高初始置信度（0.7+）的团队/项目约定。"
    }
  ]
}