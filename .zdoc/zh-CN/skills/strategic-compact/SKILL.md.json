{
  "sourceFile": "skills/strategic-compact/SKILL.md",
  "sourceLanguage": "en-US",
  "entries": [
    {
      "en-US": "---\nname: strategic-compact\ndescription: Suggests manual context compaction at logical intervals to preserve context through task phases rather than arbitrary auto-compaction.\norigin: ECC\n---",
      "zh-Hans": "---\nname: strategic-compact\ndescription: 建议在逻辑间隔处手动压缩上下文，以在任务阶段中保留上下文，而非任意的自动压缩。\norigin: ECC\n---"
    },
    {
      "en-US": "# Strategic Compact Skill",
      "zh-Hans": "# 战略精简技能"
    },
    {
      "en-US": "Suggests manual `/compact` at strategic points in your workflow rather than relying on arbitrary auto-compaction.",
      "zh-Hans": "建议在你的工作流程中的战略节点手动执行 `/compact`，而不是依赖任意的自动精简。"
    },
    {
      "en-US": "## When to Activate",
      "zh-Hans": "## 何时激活"
    },
    {
      "en-US": "- Running long sessions that approach context limits (200K+ tokens)\n- Working on multi-phase tasks (research → plan → implement → test)\n- Switching between unrelated tasks within the same session\n- After completing a major milestone and starting new work\n- When responses slow down or become less coherent (context pressure)",
      "zh-Hans": "* 运行长时间会话，接近上下文限制时（200K+ tokens）\n* 处理多阶段任务时（研究 → 规划 → 实施 → 测试）\n* 在同一会话中切换不相关的任务时\n* 完成一个主要里程碑并开始新工作时\n* 当响应变慢或连贯性下降时（上下文压力）"
    },
    {
      "en-US": "## Why Strategic Compaction?",
      "zh-Hans": "## 为何采用战略精简？"
    },
    {
      "en-US": "Auto-compaction triggers at arbitrary points:",
      "zh-Hans": "自动精简会在任意时间点触发："
    },
    {
      "en-US": "- Often mid-task, losing important context\n- No awareness of logical task boundaries\n- Can interrupt complex multi-step operations",
      "zh-Hans": "* 通常在任务中途，丢失重要上下文\n* 无法感知逻辑任务边界\n* 可能中断复杂的多步骤操作"
    },
    {
      "en-US": "Strategic compaction at logical boundaries:",
      "zh-Hans": "在逻辑边界进行战略精简："
    },
    {
      "en-US": "- **After exploration, before execution** — Compact research context, keep implementation plan\n- **After completing a milestone** — Fresh start for next phase\n- **Before major context shifts** — Clear exploration context before different task",
      "zh-Hans": "* **探索之后，执行之前** — 压缩研究上下文，保留实施计划\n* **完成里程碑之后** — 为下一阶段重新开始\n* **在主要上下文切换之前** — 在开始不同任务前清理探索上下文"
    },
    {
      "en-US": "## How It Works",
      "zh-Hans": "## 工作原理"
    },
    {
      "en-US": "The `suggest-compact.js` script runs on PreToolUse (Edit/Write) and:",
      "zh-Hans": "`suggest-compact.js` 脚本在 PreToolUse (Edit/Write) 时运行，并且："
    },
    {
      "en-US": "1. **Tracks tool calls** — Counts tool invocations in session\n2. **Threshold detection** — Suggests at configurable threshold (default: 50 calls)\n3. **Periodic reminders** — Reminds every 25 calls after threshold",
      "zh-Hans": "1. **跟踪工具调用** — 统计会话中的工具调用次数\n2. **阈值检测** — 在可配置的阈值处建议压缩（默认：50次调用）\n3. **定期提醒** — 达到阈值后，每25次调用提醒一次"
    },
    {
      "en-US": "## Hook Setup",
      "zh-Hans": "## 钩子设置"
    },
    {
      "en-US": "Add to your `~/.claude/settings.json`:",
      "zh-Hans": "添加到你的 `~/.claude/settings.json`："
    },
    {
      "en-US": "```json\n{\n  \"hooks\": {\n    \"PreToolUse\": [\n      {\n        \"matcher\": \"Edit\",\n        \"hooks\": [{ \"type\": \"command\", \"command\": \"node ~/.claude/skills/strategic-compact/suggest-compact.js\" }]\n      },\n      {\n        \"matcher\": \"Write\",\n        \"hooks\": [{ \"type\": \"command\", \"command\": \"node ~/.claude/skills/strategic-compact/suggest-compact.js\" }]\n      }\n    ]\n  }\n}\n```",
      "zh-Hans": "```json\n{\n  \"hooks\": {\n    \"PreToolUse\": [\n      {\n        \"matcher\": \"Edit\",\n        \"hooks\": [{ \"type\": \"command\", \"command\": \"node ~/.claude/skills/strategic-compact/suggest-compact.js\" }]\n      },\n      {\n        \"matcher\": \"Write\",\n        \"hooks\": [{ \"type\": \"command\", \"command\": \"node ~/.claude/skills/strategic-compact/suggest-compact.js\" }]\n      }\n    ]\n  }\n}\n```"
    },
    {
      "en-US": "## Configuration",
      "zh-Hans": "## 配置"
    },
    {
      "en-US": "Environment variables:",
      "zh-Hans": "环境变量："
    },
    {
      "en-US": "- `COMPACT_THRESHOLD` — Tool calls before first suggestion (default: 50)",
      "zh-Hans": "* `COMPACT_THRESHOLD` — 首次建议前的工具调用次数（默认：50）"
    },
    {
      "en-US": "## Compaction Decision Guide",
      "zh-Hans": "## 压缩决策指南"
    },
    {
      "en-US": "Use this table to decide when to compact:",
      "zh-Hans": "使用此表来决定何时压缩："
    },
    {
      "en-US": "| Phase Transition | Compact? | Why |\n|-----------------|----------|-----|\n| Research → Planning | Yes | Research context is bulky; plan is the distilled output |\n| Planning → Implementation | Yes | Plan is in TodoWrite or a file; free up context for code |\n| Implementation → Testing | Maybe | Keep if tests reference recent code; compact if switching focus |\n| Debugging → Next feature | Yes | Debug traces pollute context for unrelated work |\n| Mid-implementation | No | Losing variable names, file paths, and partial state is costly |\n| After a failed approach | Yes | Clear the dead-end reasoning before trying a new approach |",
      "zh-Hans": "| 阶段转换                 | 压缩？ | 原因                                                                 |\n| ------------------------ | ------ | -------------------------------------------------------------------- |\n| 研究 → 规划              | 是     | 研究上下文很庞大；规划是提炼后的输出                                 |\n| 规划 → 实施              | 是     | 规划已保存在 TodoWrite 或文件中；释放上下文以进行编码                 |\n| 实施 → 测试              | 可能   | 如果测试引用最近的代码则保留；如果要切换焦点则压缩                     |\n| 调试 → 下一项功能        | 是     | 调试痕迹会污染不相关工作的上下文                                     |\n| 实施过程中               | 否     | 丢失变量名、文件路径和部分状态代价高昂                               |\n| 尝试失败的方法之后       | 是     | 在尝试新方法之前，清理掉无效的推理过程                               |"
    },
    {
      "en-US": "## What Survives Compaction",
      "zh-Hans": "## 压缩后保留的内容"
    },
    {
      "en-US": "Understanding what persists helps you compact with confidence:",
      "zh-Hans": "了解哪些内容会保留有助于您自信地进行压缩："
    },
    {
      "en-US": "| Persists | Lost |\n|----------|------|\n| CLAUDE.md instructions | Intermediate reasoning and analysis |\n| TodoWrite task list | File contents you previously read |\n| Memory files (`~/.claude/memory/`) | Multi-step conversation context |\n| Git state (commits, branches) | Tool call history and counts |\n| Files on disk | Nuanced user preferences stated verbally |",
      "zh-Hans": "| 保留的内容                               | 丢失的内容                               |\n| ---------------------------------------- | ---------------------------------------- |\n| CLAUDE.md 指令                           | 中间的推理和分析                         |\n| TodoWrite 任务列表                       | 您之前读取过的文件内容                   |\n| 记忆文件 (`~/.claude/memory/`)           | 多轮对话的上下文                         |\n| Git 状态（提交、分支）                   | 工具调用历史和计数                       |\n| 磁盘上的文件                             | 口头陈述的细微用户偏好                   |"
    },
    {
      "en-US": "## Best Practices",
      "zh-Hans": "## 最佳实践"
    },
    {
      "en-US": "1. **Compact after planning** — Once plan is finalized in TodoWrite, compact to start fresh\n2. **Compact after debugging** — Clear error-resolution context before continuing\n3. **Don't compact mid-implementation** — Preserve context for related changes\n4. **Read the suggestion** — The hook tells you *when*, you decide *if*\n5. **Write before compacting** — Save important context to files or memory before compacting\n6. **Use `/compact` with a summary** — Add a custom message: `/compact Focus on implementing auth middleware next`",
      "zh-Hans": "1. **规划后压缩** — 一旦计划在 TodoWrite 中最终确定，就压缩以重新开始\n2. **调试后压缩** — 在继续之前，清理错误解决上下文\n3. **不要在实施过程中压缩** — 为相关更改保留上下文\n4. **阅读建议** — 钩子告诉您*何时*，您决定*是否*\n5. **压缩前写入** — 在压缩前将重要上下文保存到文件或记忆中\n6. **使用带摘要的 `/compact`** — 添加自定义消息：`/compact Focus on implementing auth middleware next`"
    },
    {
      "en-US": "## Related",
      "zh-Hans": "## 相关"
    },
    {
      "en-US": "- [The Longform Guide](https://x.com/affaanmustafa/status/2014040193557471352) — Token optimization section\n- Memory persistence hooks — For state that survives compaction\n- `continuous-learning` skill — Extracts patterns before session ends",
      "zh-Hans": "* [长篇指南](https://x.com/affaanmustafa/status/2014040193557471352) — Token 优化部分\n* 记忆持久化钩子 — 用于在压缩后保留状态\n* `continuous-learning` 技能 — 在会话结束前提取模式"
    }
  ]
}